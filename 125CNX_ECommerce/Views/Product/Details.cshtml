@model _125CNX_ECommerce.Models.ProductModel
@{
    ViewData["Title"] = Model.TenSP;
}

<!-- Breadcrumb -->
<nav aria-label="breadcrumb" class="bg-light py-3">
    <div class="container">
        <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
            <li class="breadcrumb-item"><a href="/Product">Sản phẩm</a></li>
            <li class="breadcrumb-item"><a href="/Product?category=@Model.Category.C_Name">@Model.Category.C_Name</a></li>
            <li class="breadcrumb-item active">@Model.TenSP</li>
        </ol>
    </div>
</nav>

<!-- Product Details -->
<section class="product-details py-5">
    <div class="container">
        <div class="row g-4">
            <!-- Product Images -->
            <div class="col-lg-6">
                <div class="product-images">
                    <div class="main-image mb-3">
                        <img src="@Model.Images" alt="@Model.TenSP" class="img-fluid rounded shadow" id="mainImage" style="width: 100%; height: 500px; object-fit: cover;">
                    </div>
                </div>
            </div>

            <!-- Product Info -->
            <div class="col-lg-6">
                <div class="product-info">
                    <!-- Category Badge -->
                    <div class="mb-3">
                        <span class="badge bg-primary">@Model.Category.C_Name</span>
                        @if (Model.SoLuong < 10)
                        {
                            <span class="badge bg-danger ms-2">Sắp hết hàng</span>
                        }
                        else if (Model.SoLuong > 30)
                        {
                            <span class="badge bg-success ms-2">Còn nhiều</span>
                        }
                    </div>

                    <!-- Product Name -->
                    <h2 class="fw-bold mb-3">@Model.TenSP</h2>

                    <!-- Rating -->
                    <div class="rating mb-3">
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-half text-warning"></i>
                        <span class="text-muted ms-2">(4.5/5 - 128 đánh giá)</span>
                    </div>

                    <!-- Price -->
                    <div class="price-section mb-4 p-3 bg-light rounded">
                        <h3 class="text-danger fw-bold mb-0">@Model.Gia.ToString("N0")đ</h3>
                        <small class="text-muted">Đã bao gồm VAT</small>
                    </div>

                    <!-- Product Specs -->
                    <div class="product-specs mb-4">
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="spec-item p-3 border rounded">
                                    <i class="bi bi-palette text-primary fs-4"></i>
                                    <div class="mt-2">
                                        <small class="text-muted d-block">Màu sắc</small>
                                        <strong>@Model.MauSac</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="spec-item p-3 border rounded">
                                    <i class="bi bi-rulers text-primary fs-4"></i>
                                    <div class="mt-2">
                                        <small class="text-muted d-block">Kích cỡ</small>
                                        <strong>Size @Model.KichCo</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="spec-item p-3 border rounded">
                                    <i class="bi bi-box-seam text-primary fs-4"></i>
                                    <div class="mt-2">
                                        <small class="text-muted d-block">Tình trạng</small>
                                        <strong>@(Model.SoLuong > 0 ? "Còn hàng" : "Hết hàng")</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="spec-item p-3 border rounded">
                                    <i class="bi bi-stack text-primary fs-4"></i>
                                    <div class="mt-2">
                                        <small class="text-muted d-block">Số lượng</small>
                                        <strong>Còn @Model.SoLuong</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quantity Selector -->
                    <div class="quantity-selector mb-4">
                        <label class="form-label fw-semibold">Số lượng:</label>
                        <div class="input-group" style="max-width: 150px;">
                            <button class="btn btn-outline-secondary" type="button" id="decreaseQty">
                                <i class="bi bi-dash"></i>
                            </button>
                            <input type="number" class="form-control text-center" value="1" min="1" max="@Model.SoLuong" id="quantity">
                            <button class="btn btn-outline-secondary" type="button" id="increaseQty">
                                <i class="bi bi-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons mb-4">
                        <button class="btn btn-primary btn-lg w-100 mb-2" @(Model.SoLuong == 0 ? "disabled" : "")>
                            <i class="bi bi-cart-plus me-2"></i>Thêm vào giỏ hàng
                        </button>
                        <div class="row g-2">
                            <div class="col-6">
                                <button class="btn btn-outline-danger w-100">
                                    <i class="bi bi-heart me-2"></i>Yêu thích
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-outline-secondary w-100">
                                    <i class="bi bi-arrow-left-right me-2"></i>So sánh
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Features -->
                    <div class="features-list">
                        <h6 class="fw-bold mb-3">Đặc điểm nổi bật:</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>100% chính hãng</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>Bảo hành 12 tháng</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>Đổi trả trong 30 ngày</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>Miễn phí vận chuyển đơn từ 500K</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>Thanh toán khi nhận hàng</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Product Description -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4">
                        <h4 class="fw-bold mb-4">Mô tả sản phẩm</h4>
                        <p>@Model.TenSP là sản phẩm chất lượng cao, được thiết kế với phong cách hiện đại và tiện dụng. Sản phẩm phù hợp cho nhiều hoàn cảnh sử dụng khác nhau.</p>
                        
                        <h5 class="fw-bold mt-4 mb-3">Thông số kỹ thuật:</h5>
                        <table class="table table-bordered">
                            <tbody>
                                <tr>
                                    <td class="fw-semibold" style="width: 200px;">Mã sản phẩm</td>
                                    <td>SP@Model.MaSP.ToString("D6")</td>
                                </tr>
                                <tr>
                                    <td class="fw-semibold">Danh mục</td>
                                    <td>@Model.Category.C_Name</td>
                                </tr>
                                <tr>
                                    <td class="fw-semibold">Màu sắc</td>
                                    <td>@Model.MauSac</td>
                                </tr>
                                <tr>
                                    <td class="fw-semibold">Kích cỡ</td>
                                    <td>@Model.KichCo</td>
                                </tr>
                                <tr>
                                    <td class="fw-semibold">Xuất xứ</td>
                                    <td>Chính hãng</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Related Products -->
        @if (ViewBag.RelatedProducts != null && ((List<_125CNX_ECommerce.Models.ProductModel>)ViewBag.RelatedProducts).Count > 0)
        {
            <div class="row mt-5">
                <div class="col-12">
                    <h4 class="fw-bold mb-4">Sản phẩm liên quan</h4>
                    <div class="row g-4">
                        @foreach (var product in (List<_125CNX_ECommerce.Models.ProductModel>)ViewBag.RelatedProducts)
                        {
                            <div class="col-lg-3 col-md-4 col-sm-6">
                                <div class="card border-0 shadow-sm h-100">
                                    <a href="/Product/Details/@product.MaSP">
                                        <img src="@product.Images" class="card-img-top" alt="@product.TenSP" style="height: 200px; object-fit: cover;">
                                    </a>
                                    <div class="card-body">
                                        <span class="badge bg-light text-dark border mb-2">@product.Category.C_Name</span>
                                        <h6 class="card-title">
                                            <a href="/Product/Details/@product.MaSP" class="text-decoration-none text-dark">
                                                @product.TenSP
                                            </a>
                                        </h6>
                                        <h5 class="text-danger fw-bold">@product.Gia.ToString("N0")đ</h5>
                                        <a href="/Product/Details/@product.MaSP" class="btn btn-primary btn-sm w-100">
                                            Xem chi tiết
                                        </a>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</section>

@section Scripts {
    <script>
        // Quantity controls
        document.getElementById('increaseQty').addEventListener('click', function() {
            const input = document.getElementById('quantity');
            const max = parseInt(input.max);
            const current = parseInt(input.value);
            if (current < max) {
                input.value = current + 1;
            }
        });

        document.getElementById('decreaseQty').addEventListener('click', function() {
            const input = document.getElementById('quantity');
            const min = parseInt(input.min);
            const current = parseInt(input.value);
            if (current > min) {
                input.value = current - 1;
            }
        });
    </script>
}

<style>
    .product-images .main-image {
        position: relative;
        overflow: hidden;
        border-radius: 10px;
    }

    .product-images .main-image img {
        transition: transform 0.3s ease;
    }

    .product-images .main-image:hover img {
        transform: scale(1.05);
    }

    .spec-item {
        transition: all 0.3s ease;
    }

    .spec-item:hover {
        background-color: #f8f9fa;
        transform: translateY(-2px);
    }

    .action-buttons .btn {
        transition: all 0.3s ease;
    }

    .action-buttons .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .breadcrumb-item a {
        text-decoration: none;
        color: #667eea;
    }

    .breadcrumb-item a:hover {
        text-decoration: underline;
    }
</style>
